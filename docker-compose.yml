version: "3.8"

services:
  slicer-api:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: slicer-api
    # Host mode: evita problemi di porte e consente di raggiungere Spoolman nella tua LAN
    network_mode: host
    environment:
      PUID: "911"
      PGID: "911"
      TZ: "Europe/Rome"
      SPOONMAN_URL: "http://192.168.10.164:7912"
      HOURLY_RATE: "1"
      CURRENCY: "EUR"
      # Opzionale: log verbosi
      LOG_LEVEL: "info"
    volumes:
      - ./web:/app/web:ro
      - ./profiles:/app/profiles:ro
      - ./work:/app/work
    # lsio usa s6; eseguo uvicorn tramite /init cos√¨ restano i servizi di base
    command: ["/init", "uvicorn", "slice_api:app", "--host", "0.0.0.0", "--port", "8088"]
    restart: unless-stopped
